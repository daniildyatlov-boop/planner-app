# –û–¢–ß–ï–¢ –û –°–¢–ê–ë–ò–õ–ò–ó–ê–¶–ò–ò –ê–†–•–ò–¢–ï–ö–¢–£–†–´ –ü–õ–ê–ù–ï–†–ê

## ‚úÖ –í–´–ü–û–õ–ù–ï–ù–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### 1. –ï–î–ò–ù–°–¢–í–ï–ù–ù–´–ô SOURCE OF TRUTH
- **Plans –º–∞—Å—Å–∏–≤** - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∑–∞–¥–∞—á ‚úÖ
- **Sections** - —Ç–æ–ª—å–∫–æ —à–∞–±–ª–æ–Ω—ã, –ù–ï –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∑–∞–¥–∞—á ‚úÖ
- **Habits/Nutrition** - —à–∞–±–ª–æ–Ω—ã, –ù–ï –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∑–∞–¥–∞—á ‚úÖ

### 2. –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –§–£–ù–ö–¶–ò–ò –ò–°–ü–†–ê–í–õ–ï–ù–´

#### ‚úÖ syncSectionsToPlans() - –ü–û–õ–ù–û–°–¢–¨–Æ –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù–ê
```javascript
function syncSectionsToPlans(date) {
  console.warn('‚ö†Ô∏è syncSectionsToPlans –ü–û–õ–ù–û–°–¢–¨–Æ –û–¢–ö–õ–Æ–ß–ï–ù–ê - —Ä–∞–∑–¥–µ–ª—ã –ù–ï —Å–æ–∑–¥–∞—é—Ç –∑–∞–¥–∞—á–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏');
  console.warn('üìã –ó–∞–¥–∞—á–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –¢–û–õ–¨–ö–û –≤—Ä—É—á–Ω—É—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º');
  return; // –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π –≤—ã—Ö–æ–¥ –±–µ–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏
}
```

#### ‚úÖ saveNewSection() - –£–ë–†–ê–ù –í–´–ó–û–í syncSectionsToPlans
```javascript
// –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ù–ï —Å–æ–∑–¥–∞–µ–º –∑–∞–¥–∞—á–∏ –¥–∞–∂–µ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ä–∞–∑–¥–µ–ª–∞
// –†–∞–∑–¥–µ–ª—ã - —Ç–æ–ª—å–∫–æ —à–∞–±–ª–æ–Ω—ã. –ó–∞–¥–∞—á–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –¢–û–õ–¨–ö–û –≤—Ä—É—á–Ω—É—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
// syncSectionsToPlans(currentDate); // –£–ë–†–ê–ù–û - –±–æ–ª—å—à–µ –ù–ï —Å–æ–∑–¥–∞–µ–º —Ä—É—Ç–∏–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏
```

#### ‚úÖ saveEditedSection() - –£–ë–†–ê–ù –í–´–ó–û–í syncSectionsToPlans
```javascript
// –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ù–ï —Å–æ–∑–¥–∞–µ–º –∑–∞–¥–∞—á–∏ –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ä–∞–∑–¥–µ–ª–∞
// –ó–∞–¥–∞—á–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –¢–û–õ–¨–ö–û –ø—Ä–∏ –¥–µ–π—Å—Ç–≤–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

### 3. –ù–ê–í–ò–ì–ê–¶–ò–û–ù–ù–´–ï –§–£–ù–ö–¶–ò–ò –ò–°–ü–†–ê–í–õ–ï–ù–´

#### ‚úÖ changeDay() - –ù–ï –°–û–ó–î–ê–ï–¢ –ó–ê–î–ê–ß–ò
```javascript
function changeDay(direction) {
  currentDate.setDate(currentDate.getDate() + direction);
  // –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ù–ï —Å–æ–∑–¥–∞–µ–º –∑–∞–¥–∞—á–∏ –ø—Ä–∏ —Å–º–µ–Ω–µ –¥–∞—Ç—ã
  // Plans - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã
  render();
}
```

#### ‚úÖ selectDate() - –ù–ï –°–û–ó–î–ê–ï–¢ –ó–ê–î–ê–ß–ò
```javascript
function selectDate(selectedDate) {
  currentDate = new Date(selectedDate);
  // –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ù–ï —Å–æ–∑–¥–∞–µ–º –∑–∞–¥–∞—á–∏ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –¥–∞—Ç—ã
  // Plans - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã
  render();
}
```

#### ‚úÖ initSectionsSync() - –ù–ï –°–û–ó–î–ê–ï–¢ –ó–ê–î–ê–ß–ò
```javascript
function initSectionsSync() {
  // ... –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–∑–¥–µ–ª–æ–≤
  // –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ù–ï —Å–æ–∑–¥–∞–µ–º –∑–∞–¥–∞—á–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
  // –ó–∞–¥–∞—á–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –¢–û–õ–¨–ö–û –ø—Ä–∏ –¥–µ–π—Å—Ç–≤–∏—è—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  console.log('–°–∏—Å—Ç–µ–º–∞ —Ä–∞–∑–¥–µ–ª–æ–≤ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –ë–ï–ó –∞–≤—Ç–æ—Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á');
}
```

### 4. –ú–ò–ì–†–ê–¶–ò–Ø –î–ê–ù–ù–´–• –†–ï–ê–õ–ò–ó–û–í–ê–ù–ê

#### ‚úÖ –û–¥–Ω–æ—Ä–∞–∑–æ–≤–∞—è –æ—á–∏—Å—Ç–∫–∞ —Ä—É—Ç–∏–Ω–Ω—ã—Ö –∑–∞–¥–∞—á –≤ loadData()
```javascript
const migrationKey = 'planner_migration_routine_cleanup_v2';
if (!localStorage.getItem(migrationKey)) {
  // 1. –£–¥–∞–ª—è–µ–º –≤—Å–µ –∑–∞–¥–∞—á–∏ —Å sectionId != null
  // 2. –£–¥–∞–ª—è–µ–º –≤—Å–µ –∑–∞–¥–∞—á–∏ —Å source === 'routine'
  // 3. –û—á–∏—â–∞–µ–º localStorage –æ—Ç —Å—Ç–∞—Ä—ã—Ö –∫–ª—é—á–µ–π
  // 4. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥ –º–∏–≥—Ä–∞—Ü–∏–∏
  localStorage.setItem(migrationKey, 'true');
}
```

### 5. –ó–ê–ü–†–ï–¢ –ê–í–¢–û–ì–ï–ù–ï–†–ê–¶–ò–ò –°–û–ë–õ–Æ–î–ï–ù

#### ‚ùå –ó–ê–ü–†–ï–©–ï–ù–û:
- –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á –ø—Ä–∏ load ‚úÖ
- –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á –ø—Ä–∏ render ‚úÖ
- –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á –ø—Ä–∏ —Å–º–µ–Ω–µ –¥–∞—Ç—ã ‚úÖ
- –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ä–∞–∑–¥–µ–ª–æ–≤ ‚úÖ

#### ‚úÖ –†–ê–ó–†–ï–®–ï–ù–û:
- –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á –ø—Ä–∏ —è–≤–Ω–æ–º –¥–µ–π—Å—Ç–≤–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚úÖ
- –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á –ø–æ –∫–Ω–æ–ø–∫–µ ‚úÖ
- –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á –ø–∏—Ç–∞–Ω–∏—è –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø—Ä–∏–µ–º–∞ –ø–∏—â–∏ ‚úÖ

### 6. –ß–ï–¢–ö–û–ï –†–ê–ó–î–ï–õ–ï–ù–ò–ï –°–£–©–ù–û–°–¢–ï–ô

#### Sections (–†–∞–∑–¥–µ–ª—ã):
- id, name, icon, schedule, templateTasks ‚úÖ
- –ù–ï —Å–æ–¥–µ—Ä–∂–∞—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ ‚úÖ
- –¢–æ–ª—å–∫–æ —à–∞–±–ª–æ–Ω—ã ‚úÖ

#### Plans (–ó–∞–¥–∞—á–∏):
- id, title, date, completed, sectionId (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) ‚úÖ
- –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã ‚úÖ
- –ù–∏–∫–∞–∫–æ–π –º–∞–≥–∏–∏ –º–µ–∂–¥—É —Å—É—â–Ω–æ—Å—Ç—è–º–∏ ‚úÖ

## üß™ –ü–†–û–í–ï–†–ö–ê –ì–û–¢–û–í–ù–û–°–¢–ò

### –°—Ü–µ–Ω–∞—Ä–∏–π –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å:
1. ‚úÖ –°–æ–∑–¥–∞—Ç—å —Ä–∞–∑–¥–µ–ª —Å —à–∞–±–ª–æ–Ω–∞–º–∏ ‚Üí –ó–∞–¥–∞—á–∏ –ù–ï –ø–æ—è–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
2. ‚úÖ –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É –≤—Ä—É—á–Ω—É—é ‚Üí –†–∞–±–æ—Ç–∞–µ—Ç
3. ‚úÖ –£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É ‚Üí –†–∞–±–æ—Ç–∞–µ—Ç
4. ‚úÖ Reload ‚Üí –ó–∞–¥–∞—á–∏ –ù–ï–¢
5. ‚úÖ –°–º–µ–Ω–∏—Ç—å –¥–∞—Ç—É –∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è ‚Üí –ó–∞–¥–∞—á–∏ –ù–ï–¢

## üìã –ò–¢–û–ì–û–í–û–ï –°–û–°–¢–û–Ø–ù–ò–ï

### ‚úÖ –î–û–°–¢–ò–ì–ù–£–¢–û:
- –ö–æ–¥ –∏–º–µ–µ—Ç –æ–¥–∏–Ω –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã (plans)
- –£–¥–∞–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–≤—Å–µ–≥–¥–∞
- –†—É—Ç–∏–Ω–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã –ù–ï –ª–æ–º–∞—é—Ç –ø–ª–∞–Ω—ã
- –ü—Ä–æ–µ–∫—Ç —Å—Ç–∞–±–∏–ª–µ–Ω –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–∞

### üîí –ì–ê–†–ê–ù–¢–ò–ò:
- syncSectionsToPlans() –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞
- –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
- –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–¥–∞—á –∑–∞–ø—Ä–µ—â–µ–Ω–∞
- –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã —Å–æ–±–ª—é–¥–µ–Ω

## üéØ –†–ï–ó–£–õ–¨–¢–ê–¢

**–ü–†–û–ï–ö–¢ –ü–û–õ–ù–û–°–¢–¨–Æ –°–¢–ê–ë–ò–õ–ò–ó–ò–†–û–í–ê–ù**

–£–¥–∞–ª–µ–Ω–Ω—ã–µ —Ä—É—Ç–∏–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ –±–æ–ª—å—à–µ –ù–ï –í–û–ó–í–†–ê–©–ê–Æ–¢–°–Ø –ø–æ—Å–ª–µ reload.
–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã.
–ö–æ–¥ –ø—Ä–∏–≤–µ–¥–µ–Ω –≤ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.