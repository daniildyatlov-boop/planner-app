<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no, viewport-fit=cover">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <title>–ü–ª–∞–Ω–µ—Ä STABLE</title>
    <script src="https://telegram.org/js/telegram-web-app.js?v=7"></script>
    <link rel="stylesheet" href="./src/styles/bundle.css">
</head>
<body>
    <div class="app">
        <div class="header">
            <button class="profile-btn" data-action="SHOW_PROFILE_MENU">–ü</button>
            <div class="date-nav">
                <button class="nav-arrow" data-action="CHANGE_DATE" data-params='{"days": -1}'>‚Äπ</button>
                <div class="date-content" data-action="SHOW_DATE_PICKER">
                    <div class="date-title" id="dayTitle">–°–µ–≥–æ–¥–Ω—è</div>
                    <div class="date-subtitle" id="daySubtitle">–ü–Ω, 27 —è–Ω–≤.</div>
                </div>
                <button class="nav-arrow" data-action="CHANGE_DATE" data-params='{"days": 1}'>‚Ä∫</button>
            </div>
            <button class="rooms-btn" data-action="SHOW_ROOMS_MODAL" id="roomsBtn">üè†</button>
        </div>

        <div class="content">
            <div class="progress-container" id="progressContainer">
                <div class="progress-info">
                    <div class="progress-label" id="progressLabel">–ü—Ä–æ–≥—Ä–µ—Å—Å –¥–Ω—è</div>
                    <div class="progress-stats" id="progressStats">0/0</div>
                </div>
                <div class="progress-circle-container">
                    <div class="progress-circle" id="progressCircle">
                        <div class="progress-circle-inner">
                            <div class="progress-percentage" id="progressPercentage">0%</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="empty" id="empty">
                <h2>–ü–ª–∞–Ω–æ–≤ –Ω–µ—Ç</h2>
                <p>–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é –∑–∞–¥–∞—á—É</p>
                <button class="btn" data-action="ADD_TASK_MODAL">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</button>
            </div>

            <div class="plans-container" id="plansContainer" style="display:none">
                <div class="plans" id="plans"></div>
            </div>
            
            <div class="nutrition-container" id="nutritionContainer" style="display:none"></div>
            <div class="habits-container" id="habitsContainer" style="display:none"></div>
        </div>
    </div>

    <div class="bottom-nav" id="bottomNav">
        <button class="nav-item active" data-action="SWITCH_TAB" data-params='{"tab": "tasks"}' data-tab="tasks">
            <div class="nav-icon" id="tasksIcon">üìù</div>
            <div class="nav-label">–ó–∞–¥–∞—á–∏</div>
        </button>
        <button class="nav-item" data-action="SWITCH_TAB" data-params='{"tab": "nutrition"}' data-tab="nutrition">
            <div class="nav-icon" id="nutritionIcon">üçΩÔ∏è</div>
            <div class="nav-label">–ü–∏—Ç–∞–Ω–∏–µ</div>
        </button>
        <button class="nav-item" data-action="SWITCH_TAB" data-params='{"tab": "habits"}' data-tab="habits">
            <div class="nav-icon" id="habitsIcon">üéØ</div>
            <div class="nav-label">–ü—Ä–∏–≤—ã—á–∫–∏</div>
        </button>
    </div>

    <div class="modal" id="addModal">
        <div class="modal-header">
            <button class="header-btn" data-action="CLOSE_MODAL">–û—Ç–º–µ–Ω–∞</button>
            <div class="modal-title">–ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞</div>
            <button class="header-btn-primary" data-action="CREATE_TASK_FROM_MODAL">–ì–æ—Ç–æ–≤–æ</button>
        </div>
        <div class="modal-content">
            <div class="form-group">
                <label class="label">–ß—Ç–æ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ</label>
                <input class="input" id="planTitle" placeholder="–ß—Ç–æ –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ —Å–¥–µ–ª–∞—Ç—å?" autofocus>
            </div>
            <div class="form-group">
                <label class="label">–î–∞—Ç–∞</label>
                <input type="date" class="input" id="planDate">
            </div>
            <div class="form-group">
                <label class="label">–í—Ä–µ–º—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                <input type="time" class="input" id="planTime" placeholder="–í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è">
            </div>
            <div class="form-group">
                <label class="label">–†–∞–∑–¥–µ–ª</label>
                <div class="select-wrapper">
                    <select class="select" id="planRoom">
                        <option value="">–ë–µ–∑ —Ä–∞–∑–¥–µ–ª–∞</option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    <div class="calendar" id="calendar" data-action="HIDE_CALENDAR">
        <div class="calendar-content" data-action="NONE">
            <div class="calendar-header">
                <button class="calendar-nav" data-action="CHANGE_CALENDAR_MONTH" data-params='{"delta": -1}'>‚Äπ</button>
                <div class="calendar-title" id="calendarTitle">–Ø–Ω–≤–∞—Ä—å 2026</div>
                <button class="calendar-nav" data-action="CHANGE_CALENDAR_MONTH" data-params='{"delta": 1}'>‚Ä∫</button>
            </div>
            <div class="weekdays">
                <div class="weekday">–ü–Ω</div>
                <div class="weekday">–í—Ç</div>
                <div class="weekday">–°—Ä</div>
                <div class="weekday">–ß—Ç</div>
                <div class="weekday">–ü—Ç</div>
                <div class="weekday">–°–±</div>
                <div class="weekday">–í—Å</div>
            </div>
            <div class="calendar-grid" id="calendarGrid"></div>
        </div>
    </div>

    <div class="screen" id="editPlanScreen">
        <div class="screen-header">
            <button class="header-btn" data-action="CLOSE_MODAL">–ù–∞–∑–∞–¥</button>
            <div class="modal-title">–ò–∑–º–µ–Ω–∏—Ç—å –∑–∞–¥–∞—á—É</div>
            <div></div>
        </div>
        <div class="screen-content">
            <div class="form-group">
                <input class="input edit-plan-input" id="editPlanTitle" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏">
            </div>
            <div class="form-group">
                <label class="label">–î–∞—Ç–∞</label>
                <div class="form-row" data-action="SHOW_EDIT_DATE_PICKER">
                    <span id="editPlanDate">26 —è–Ω–≤. 2026–≥.</span>
                </div>
            </div>
            <div class="form-group">
                <label class="label">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ</label>
                <div class="form-row">
                    <span>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ</span>
                    <div class="toggle" id="notificationToggle" data-action="TOGGLE_NOTIFICATION">
                        <div class="toggle-slider"></div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="label">–í–∞–∂–Ω–∞—è</label>
                <div class="form-row">
                    <span>–í–∞–∂–Ω–∞—è</span>
                    <div class="toggle" id="importantToggle" data-action="TOGGLE_IMPORTANT">
                        <div class="toggle-slider"></div>
                    </div>
                </div>
            </div>
            <button class="delete-btn" data-action="DELETE_TASK_FROM_EDIT">–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É</button>
        </div>
        
        <div class="screen-footer">
            <button class="save-btn" data-action="SAVE_TASK_EDIT">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
    </div>

    <div class="overlay" id="overlay" data-action="CLOSE_MODAL">
        <div class="menu" id="menu" data-action="NONE">
            <button class="menu-btn" data-action="EDIT_TASK_FROM_MENU">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
            <button class="menu-btn del" data-action="DELETE_TASK_FROM_MENU">–£–¥–∞–ª–∏—Ç—å</button>
        </div>
    </div>

    <div class="screen" id="roomsScreen">
        <div class="screen-header">
            <button class="header-btn" data-action="CLOSE_MODAL">–ù–∞–∑–∞–¥</button>
            <div class="modal-title">–†–∞–∑–¥–µ–ª—ã</div>
            <button class="header-btn-primary" data-action="CLOSE_MODAL">–ì–æ—Ç–æ–≤–æ</button>
        </div>
        <div class="screen-content">
            <div class="sections-manager-card" data-action="SHOW_SECTIONS" style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.1) 50%, rgba(168, 85, 247, 0.1) 100%);backdrop-filter: blur(30px);border: 1px solid rgba(99, 102, 241, 0.2);">
                <div class="sections-card-icon">üìö</div>
                <div class="sections-card-content">
                    <div class="sections-card-title">–†—É—Ç–∏–Ω—ã</div>
                    <div class="sections-card-desc">–ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ —É—Ç—Ä–æ, –≤–µ—á–µ—Ä –∏ –¥—Ä—É–≥–∏–µ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –¥–µ–ª–∞</div>
                </div>
                <div class="sections-card-arrow">‚Ä∫</div>
            </div>
            <div class="rooms-list" id="roomsList"></div>
        </div>
        <button class="add-room-fab" data-action="SHOW_ADD_ROOM_MODAL">+</button>
    </div>

    <div class="screen" id="profileScreen">
        <div class="screen-header">
            <button class="header-btn" data-action="HIDE_PROFILE_MENU">–ù–∞–∑–∞–¥</button>
            <div class="modal-title">–ü—Ä–æ—Ñ–∏–ª—å</div>
            <button class="header-btn-primary" data-action="HIDE_PROFILE_MENU">–ì–æ—Ç–æ–≤–æ</button>
        </div>
        <div class="screen-content">
            <div class="profile-section">
                <div class="profile-avatar">
                    <div class="avatar-circle">–ü</div>
                    <div class="profile-name" id="profileName">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</div>
                    <button class="edit-name-btn" data-action="EDIT_NAME">–ò–∑–º–µ–Ω–∏—Ç—å –∏–º—è</button>
                </div>
            </div>
            <div class="profile-menu">
                <button class="profile-menu-btn" data-action="SHOW_ACCOUNT">
                    <div class="menu-btn-icon" id="profileIcon">üë§</div>
                    <div class="menu-btn-text">
                        <div class="menu-btn-title">–ê–∫–∫–∞—É–Ω—Ç</div>
                        <div class="menu-btn-desc">–õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –ø–æ–¥–ø–∏—Å–∫–∞</div>
                    </div>
                    <div class="menu-btn-arrow">‚Ä∫</div>
                </button>
                <button class="profile-menu-btn" data-action="SHOW_SETTINGS">
                    <div class="menu-btn-icon" id="settingsIcon">‚öôÔ∏è</div>
                    <div class="menu-btn-text">
                        <div class="menu-btn-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
                        <div class="menu-btn-desc">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è</div>
                    </div>
                    <div class="menu-btn-arrow">‚Ä∫</div>
                </button>
                <button class="profile-menu-btn" data-action="SHOW_SUPPORT">
                    <div class="menu-btn-icon" id="supportIcon">üí¨</div>
                    <div class="menu-btn-text">
                        <div class="menu-btn-title">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</div>
                        <div class="menu-btn-desc">–ü–æ–º–æ—â—å –∏ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å</div>
                    </div>
                    <div class="menu-btn-arrow">‚Ä∫</div>
                </button>
            </div>
        </div>
    </div>

    <div class="modal" id="addRoomModal">
        <div class="modal-header">
            <button class="header-btn" data-action="CLOSE_MODAL">–û—Ç–º–µ–Ω–∞</button>
            <div class="modal-title">–ù–æ–≤—ã–π —Ä–∞–∑–¥–µ–ª</div>
            <button class="header-btn-primary" data-action="CREATE_ROOM_FROM_MODAL">–°–æ–∑–¥–∞—Ç—å</button>
        </div>
        <div class="modal-content">
            <div class="form-group">
                <label class="label">–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–∞</label>
                <input class="input" id="newRoomTitle" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –°–ø–æ—Ä—Ç">
            </div>
            <div class="form-group">
                <label class="label">–ò–∫–æ–Ω–∫–∞</label>
                <div class="icons-grid" id="roomIconsGrid"></div>
            </div>
        </div>
    </div>

    <div class="screen" id="sectionsScreen">
        <div class="screen-header">
            <button class="header-btn" data-action="CLOSE_MODAL">–ù–∞–∑–∞–¥</button>
            <div class="modal-title">–†—É—Ç–∏–Ω–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã</div>
            <button class="header-btn-primary" data-action="CLOSE_MODAL">–ì–æ—Ç–æ–≤–æ</button>
        </div>
        <div class="screen-content">
            <div id="sectionsList"></div>
        </div>
        <button class="add-room-fab" data-action="SHOW_ADD_SECTION_MODAL">+</button>
    </div>

    <div class="modal" id="addSectionModal">
        <div class="modal-header">
            <button class="header-btn" data-action="CLOSE_MODAL">–û—Ç–º–µ–Ω–∞</button>
            <div class="modal-title">–ù–æ–≤—ã–π —Ä–∞–∑–¥–µ–ª</div>
            <button class="header-btn-primary" data-action="CREATE_SECTION_FROM_MODAL">–°–æ–∑–¥–∞—Ç—å</button>
        </div>
        <div class="modal-content">
            <div class="form-group">
                <label class="label">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
                <input class="input" id="newSectionTitle" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –£—Ç—Ä–æ">
            </div>
        </div>
    </div>

    <div class="popup" id="popup">
        <div class="popup-content">
            <div class="popup-title" id="popupTitle">–ó–∞–≥–æ–ª–æ–≤–æ–∫</div>
            <div class="popup-message" id="popupMessage">–°–æ–æ–±—â–µ–Ω–∏–µ</div>
            <div class="popup-buttons" id="popupButtons"></div>
        </div>
    </div>

    <script type="module" src="./src/main.js"></script>
</body>
</html>
