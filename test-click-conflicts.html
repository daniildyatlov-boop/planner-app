<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –∫–ª–∏–∫–æ–≤ - –ü—Ä–∏–≤—ã—á–∫–∏</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .test-container {
            max-width: 400px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .test-section {
            margin-bottom: 30px;
            padding: 15px;
            border: 2px solid #e5e5e5;
            border-radius: 12px;
        }
        
        .test-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #333;
        }
        
        .test-result {
            padding: 10px;
            margin: 5px 0;
            border-radius: 8px;
            font-size: 14px;
        }
        
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        
        .habit-card-test {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 16px;
            margin: 10px 0;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            min-height: 72px;
        }
        
        .habit-card-test:hover {
            background: #e9ecef;
            border-color: #6366f1;
            transform: translateY(-2px);
        }
        
        .habit-card-test:active {
            transform: scale(0.98);
            background: #dee2e6;
        }
        
        .habit-icon-test {
            font-size: 24px;
            width: 40px;
            text-align: center;
        }
        
        .habit-content-test {
            flex: 1;
        }
        
        .habit-title-test {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }
        
        .habit-frequency-test {
            font-size: 12px;
            color: #6b7280;
        }
        
        .habit-checkbox-test {
            width: 28px;
            height: 28px;
            border: 2px solid #22c55e;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
            pointer-events: none;
        }
        
        .habit-checkbox-test.checked {
            background: #22c55e;
            color: white;
        }
        
        .habit-menu-btn-test {
            width: 44px;
            height: 44px;
            background: rgba(0,0,0,0.1);
            border: none;
            border-radius: 22px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.2s ease;
        }
        
        .habit-menu-btn-test:hover {
            background: rgba(0,0,0,0.2);
            transform: scale(1.1);
        }
        
        .habit-menu-btn-test:active {
            transform: scale(0.95);
        }
        
        .click-counter {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #333;
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 14px;
            z-index: 1000;
        }
        
        .test-button {
            background: #6366f1;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
            transition: all 0.2s ease;
        }
        
        .test-button:hover {
            background: #5856eb;
            transform: translateY(-1px);
        }
        
        .test-button:active {
            transform: scale(0.98);
        }
    </style>
</head>
<body>
    <div class="click-counter" id="clickCounter">
        –ö–ª–∏–∫–æ–≤: 0
    </div>
    
    <div class="test-container">
        <h1>üß™ –¢–µ—Å—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –∫–ª–∏–∫–æ–≤</h1>
        <p>–ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –∏–º–µ–µ—Ç –¢–û–õ–¨–ö–û –æ–¥–Ω–æ –¥–µ–π—Å—Ç–≤–∏–µ</p>
        
        <div class="test-section">
            <div class="test-title">1. –ö–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–∏–≤—ã—á–∫–∏</div>
            <div class="test-result" id="cardTest">–û–∂–∏–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞...</div>
            
            <div class="habit-card-test" id="testHabitCard" data-habit-id="test-habit">
                <div class="habit-icon-test">üí™</div>
                <div class="habit-content-test">
                    <div class="habit-title-test">–¢–µ—Å—Ç–æ–≤–∞—è –ø—Ä–∏–≤—ã—á–∫–∞</div>
                    <div class="habit-frequency-test">–ö–∞–∂–¥—ã–π –¥–µ–Ω—å</div>
                </div>
                <div class="habit-checkbox-test" id="testCheckbox"></div>
                <button class="habit-menu-btn-test" id="testMenuBtn" data-habit-id="test-habit">‚ãØ</button>
            </div>
            
            <p><strong>–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:</strong></p>
            <ul>
                <li>–ö–ª–∏–∫ –ø–æ –∫–∞—Ä—Ç–æ—á–∫–µ = toggle –ø—Ä–∏–≤—ã—á–∫–∏</li>
                <li>–ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ "‚ãØ" = –ø–æ–∫–∞–∑–∞—Ç—å –º–µ–Ω—é</li>
                <li>–ß–µ–∫–±–æ–∫—Å –ù–ï –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–π</li>
                <li>–ù–∏–∫–∞–∫–∏—Ö –¥–≤–æ–π–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π</li>
            </ul>
        </div>
        
        <div class="test-section">
            <div class="test-title">2. Touch Zone —Ç–µ—Å—Ç</div>
            <div class="test-result" id="touchTest">–û–∂–∏–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞...</div>
            
            <p>–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –∫–Ω–æ–ø–æ–∫:</p>
            <button class="test-button" style="width: 44px; height: 44px;">44px</button>
            <button class="test-button" style="width: 32px; height: 32px;">32px</button>
            <button class="test-button" style="width: 48px; height: 48px;">48px</button>
        </div>
        
        <div class="test-section">
            <div class="test-title">3. Debounce —Ç–µ—Å—Ç</div>
            <div class="test-result" id="debounceTest">–û–∂–∏–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞...</div>
            
            <button class="test-button" id="debounceBtn">–ë—ã—Å—Ç—Ä–æ –∫–ª–∏–∫–∞–π –º–µ–Ω—è!</button>
            <div id="debounceCounter">–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –∫–ª–∏–∫–æ–≤: 0</div>
        </div>
        
        <div class="test-section">
            <div class="test-title">4. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤</div>
            <div id="testResults">
                <div class="test-result warning">–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã</div>
            </div>
            
            <button class="test-button" onclick="runAllTests()">üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã</button>
            <button class="test-button" onclick="resetTests()">üîÑ –°–±—Ä–æ—Å–∏—Ç—å</button>
        </div>
    </div>

    <script>
        let clickCount = 0;
        let habitToggleCount = 0;
        let menuClickCount = 0;
        let debounceClickCount = 0;
        let lastDebounceTime = 0;
        
        // –°—á–µ—Ç—á–∏–∫ –∫–ª–∏–∫–æ–≤
        function updateClickCounter() {
            clickCount++;
            document.getElementById('clickCounter').textContent = `–ö–ª–∏–∫–æ–≤: ${clickCount}`;
        }
        
        // –ò–º–∏—Ç–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ toggle –ø—Ä–∏–≤—ã—á–∫–∏ —Å debounce
        function toggleHabitCompletion(habitId) {
            const now = Date.now();
            if (now - lastDebounceTime < 300) {
                console.log('üö´ Debounce: –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∫–ª–∏–∫');
                return;
            }
            lastDebounceTime = now;
            
            habitToggleCount++;
            const checkbox = document.getElementById('testCheckbox');
            checkbox.classList.toggle('checked');
            checkbox.textContent = checkbox.classList.contains('checked') ? '‚úì' : '';
            
            console.log(`‚úÖ –ü—Ä–∏–≤—ã—á–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∞ (${habitToggleCount})`);
            updateClickCounter();
        }
        
        // –ò–º–∏—Ç–∞—Ü–∏—è –ø–æ–∫–∞–∑–∞ –º–µ–Ω—é
        function showHabitContextMenu(habitId, event) {
            event.stopPropagation();
            menuClickCount++;
            console.log(`üìã –ú–µ–Ω—é –ø–æ–∫–∞–∑–∞–Ω–æ (${menuClickCount})`);
            alert(`–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é –¥–ª—è –ø—Ä–∏–≤—ã—á–∫–∏ ${habitId}`);
            updateClickCounter();
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        document.addEventListener('click', (e) => {
            // –ö–Ω–æ–ø–∫–∞ –º–µ–Ω—é
            if (e.target.closest('#testMenuBtn')) {
                e.preventDefault();
                e.stopPropagation();
                const btn = e.target.closest('#testMenuBtn');
                const habitId = btn.dataset.habitId;
                showHabitContextMenu(habitId, e);
                return;
            }
            
            // –ö–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–∏–≤—ã—á–∫–∏
            if (e.target.closest('#testHabitCard')) {
                e.preventDefault();
                e.stopPropagation();
                const card = e.target.closest('#testHabitCard');
                const habitId = card.dataset.habitId;
                toggleHabitCompletion(habitId);
                return;
            }
        });
        
        // Debounce —Ç–µ—Å—Ç
        let debounceProcessedCount = 0;
        document.getElementById('debounceBtn').addEventListener('click', (e) => {
            debounceClickCount++;
            
            // –ü—Ä–æ—Å—Ç–æ–π debounce
            const now = Date.now();
            if (!window.testDebounce) window.testDebounce = 0;
            
            if (now - window.testDebounce < 200) {
                console.log('üö´ Debounce —Å—Ä–∞–±–æ—Ç–∞–ª');
                return;
            }
            window.testDebounce = now;
            
            debounceProcessedCount++;
            document.getElementById('debounceCounter').textContent = 
                `–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –∫–ª–∏–∫–æ–≤: ${debounceProcessedCount} –∏–∑ ${debounceClickCount}`;
        });
        
        // –¢–µ—Å—Ç—ã
        function runAllTests() {
            const results = [];
            
            // –¢–µ—Å—Ç 1: –†–∞–∑–º–µ—Ä—ã –∫–Ω–æ–ø–æ–∫
            const menuBtn = document.getElementById('testMenuBtn');
            const btnRect = menuBtn.getBoundingClientRect();
            if (btnRect.width >= 44 && btnRect.height >= 44) {
                results.push('<div class="test-result success">‚úÖ Touch zone: –∫–Ω–æ–ø–∫–∞ –º–µ–Ω—é 44px+</div>');
            } else {
                results.push('<div class="test-result error">‚ùå Touch zone: –∫–Ω–æ–ø–∫–∞ –º–µ–Ω—é –º–µ–Ω—å—à–µ 44px</div>');
            }
            
            // –¢–µ—Å—Ç 2: –ß–µ–∫–±–æ–∫—Å –Ω–µ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–π
            const checkbox = document.getElementById('testCheckbox');
            const checkboxStyle = window.getComputedStyle(checkbox);
            if (checkboxStyle.pointerEvents === 'none') {
                results.push('<div class="test-result success">‚úÖ –ß–µ–∫–±–æ–∫—Å: pointer-events: none</div>');
            } else {
                results.push('<div class="test-result error">‚ùå –ß–µ–∫–±–æ–∫—Å: –º–æ–∂–µ—Ç –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –∫–ª–∏–∫–∏</div>');
            }
            
            // –¢–µ—Å—Ç 3: –ö–∞—Ä—Ç–æ—á–∫–∞ –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏
            const card = document.getElementById('testHabitCard');
            const cardStyle = window.getComputedStyle(card);
            if (cardStyle.userSelect === 'none' && cardStyle.cursor === 'pointer') {
                results.push('<div class="test-result success">‚úÖ –ö–∞—Ä—Ç–æ—á–∫–∞: –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏</div>');
            } else {
                results.push('<div class="test-result warning">‚ö†Ô∏è –ö–∞—Ä—Ç–æ—á–∫–∞: –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∏–ª–∏</div>');
            }
            
            // –¢–µ—Å—Ç 4: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞
            const cardRect = card.getBoundingClientRect();
            if (cardRect.height >= 72) {
                results.push('<div class="test-result success">‚úÖ –ö–∞—Ä—Ç–æ—á–∫–∞: –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ 72px+</div>');
            } else {
                results.push('<div class="test-result warning">‚ö†Ô∏è –ö–∞—Ä—Ç–æ—á–∫–∞: –≤—ã—Å–æ—Ç–∞ –º–µ–Ω—å—à–µ 72px</div>');
            }
            
            results.push('<div class="test-result success">üéØ –¢–µ—Å—Ç—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤—Ä—É—á–Ω—É—é.</div>');
            
            document.getElementById('testResults').innerHTML = results.join('');
        }
        
        function resetTests() {
            clickCount = 0;
            habitToggleCount = 0;
            menuClickCount = 0;
            debounceClickCount = 0;
            debounceProcessedCount = 0;
            lastDebounceTime = 0;
            window.testDebounce = 0;
            
            document.getElementById('clickCounter').textContent = '–ö–ª–∏–∫–æ–≤: 0';
            document.getElementById('debounceCounter').textContent = '–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –∫–ª–∏–∫–æ–≤: 0';
            document.getElementById('testCheckbox').classList.remove('checked');
            document.getElementById('testCheckbox').textContent = '';
            document.getElementById('testResults').innerHTML = '<div class="test-result warning">–¢–µ—Å—Ç—ã —Å–±—Ä–æ—à–µ–Ω—ã</div>';
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            setTimeout(runAllTests, 500);
        });
    </script>
</body>
</html>